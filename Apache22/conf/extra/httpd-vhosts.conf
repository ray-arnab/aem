#
# Virtual Hosts
#
# If you want to maintain multiple domains/hostnames on your
# machine you can setup VirtualHost containers for them. Most configurations
# use only name-based virtual hosts so the server doesn't need to worry about
# IP addresses. This is indicated by the asterisks in the directives below.
#
# Please see the documentation at 
# <URL:http://httpd.apache.org/docs/2.2/vhosts/>
# for further details before you try to setup virtual hosts.
#
# You may use the command line option '-S' to verify your virtual host
# configuration.

#
# Use name-based virtual hosting.
#
NameVirtualHost *:80

#
# VirtualHost example:
# Almost any Apache directive may go into a VirtualHost container.
# The first VirtualHost section is used for all requests that do not
# match a ServerName or ServerAlias in any <VirtualHost> block.
#
<VirtualHost _default_:80>
    DocumentRoot "/Apache22/htdocs"
    ServerName localhost
    ErrorLog "logs/error.log"
    CustomLog "logs/access.log" common
</VirtualHost>


#
# Company Intranet
#
Use VHost_Company_Intranet us "/en/"
Use VHost_Company_Intranet fr "/fr/"


#
# Company SPA
#
<VirtualHost *:80>
	ServerAdmin webmaster@spa.company.com
	DocumentRoot "/Apache22/htdocs"
	ServerName local.spa.company.com
	
	RewriteEngine on
	
	RewriteRule    ^/$  /en.html [R=301,QSA]
	
	
	<IfModule mod_proxy_http.c>
		#RequestHeader set X-Prerender-Token "qKzkb3PmxGEUtYlRNIrS"
		
        RewriteCond %{HTTP_USER_AGENT} baiduspider|facebookexternalhit|twitterbot|rogerbot|linkedinbot|embedly|quora\ link\ preview|showyoubot|outbrain|pinterest|slackbot|vkShare|W3C_Validator [NC,OR]
        RewriteCond %{QUERY_STRING} _escaped_fragment_
        
        # Only proxy the request to Prerender if it's a request for HTML
		#RewriteRule ^(?!.*?(\.js|\.css|\.xml|\.less|\.png|\.jpg|\.jpeg|\.gif|\.pdf|\.doc|\.txt|\.ico|\.rss|\.zip|\.mp3|\.rar|\.exe|\.wmv|\.doc|\.avi|\.ppt|\.mpg|\.mpeg|\.tif|\.wav|\.mov|\.psd|\.ai|\.xls|\.mp4|\.m4a|\.swf|\.dat|\.dmg|\.iso|\.flv|\.m4v|\.torrent|\.ttf|\.woff))(.*) http://service.prerender.io/http://example.com/$2 [P,L]
        RewriteRule ^(?!.*?(\.js|\.css|\.xml|\.less|\.png|\.jpg|\.jpeg|\.gif|\.pdf|\.doc|\.txt|\.ico|\.rss|\.zip|\.mp3|\.rar|\.exe|\.wmv|\.doc|\.avi|\.ppt|\.mpg|\.mpeg|\.tif|\.wav|\.mov|\.psd|\.ai|\.xls|\.mp4|\.m4a|\.swf|\.dat|\.dmg|\.iso|\.flv|\.m4v|\.torrent|\.ttf|\.woff))(.*) http://localhost:3000/http://%{HTTP_HOST}/$2 [P,L]
    </IfModule>
	
	#RewriteRule    ^/(.+)/app/(.+)$  /$1.html#/$2 [R=302,QSA]
	#RewriteRule    ^/(.+)/app/(.+)$  /$1#/$2 [R=302,QSA]
	
	RewriteCond %{REQUEST_URI} !^/apps
	RewriteCond %{REQUEST_URI} !^/bin
	RewriteCond %{REQUEST_URI} !^/content
	RewriteCond %{REQUEST_URI} !^/etc
	RewriteCond %{REQUEST_URI} !^/home
	RewriteCond %{REQUEST_URI} !^/libs
	RewriteCond %{REQUEST_URI} !^/tmp
	RewriteCond %{REQUEST_URI} !^/var
	RewriteRule    ^/(.+)$  /content/company-spa/$1 [PT,L]
	
	ErrorLog "logs/spa.company.com-error.log"
	CustomLog "logs/spa.company.com-access.log" common    
</VirtualHost>






#
# Static assets of company.net
#
<VirtualHost *:80>
	ServerAdmin webmaster@static.company.net
	DocumentRoot "/Apache22/htdocs"
	ServerName static.company.net
	ServerAlias static1.company.net
	ServerAlias static2.company.net
	
	RewriteEngine on
	RewriteRule    ^/(.*)  /$1 [PT,L]
	
	ErrorLog "logs/static.company.net-error.log"
	CustomLog "logs/static.company.net-access.log" common    
</VirtualHost>


#
# SPA
#
<VirtualHost *:80>
	ServerAdmin webmaster@spa.com
	DocumentRoot "/Apache22/htdocs"
	ServerName local.spa.com
	
	RewriteEngine on
	
	RewriteRule    ^/$  /index.html [R=301,QSA]
	
	
	<IfModule mod_proxy_http.c>
		# Such a token may come into play for using Prerender.io cloud solution
		#RequestHeader set X-Prerender-Token "qKzkb3PmxGEUtYlRNIrS"
		
        RewriteCond %{HTTP_USER_AGENT} baiduspider|facebookexternalhit|twitterbot|rogerbot|linkedinbot|embedly|quora\ link\ preview|showyoubot|outbrain|pinterest|slackbot|vkShare|W3C_Validator [NC,OR]
        RewriteCond %{QUERY_STRING} _escaped_fragment_
        
        # Only proxy the request to Prerender if it's a request for HTML
		RewriteRule ^(?!.*?(\.js|\.css|\.xml|\.less|\.png|\.jpg|\.jpeg|\.gif|\.pdf|\.doc|\.txt|\.ico|\.rss|\.zip|\.mp3|\.rar|\.exe|\.wmv|\.doc|\.avi|\.ppt|\.mpg|\.mpeg|\.tif|\.wav|\.mov|\.psd|\.ai|\.xls|\.mp4|\.m4a|\.swf|\.dat|\.dmg|\.iso|\.flv|\.m4v|\.torrent|\.ttf|\.woff))(.*) http://localhost:3000/http://%{HTTP_HOST}/$2 [P,L]
    </IfModule>
	
	RewriteRule    ^/(.+)$  http://localhost:8083/$1 [P,L]
	
	ErrorLog "logs/spa.com-error.log"
	CustomLog "logs/spa.com-access.log" common    
</VirtualHost>